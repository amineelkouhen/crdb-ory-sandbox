= Multi-Region Deployment

This configuration consists of a Multi-Region, Multi-AZ (Availability Zone) cloud architecture designed for high availability, fault tolerance, and global scalability. It features three distinct geographical regions, each containing three isolated Availability Zones (AZ1, AZ2, and AZ3).

In these three regions, we deploy two clusters:

- Ory Cluster: deployed in separate Virtual Private Clouds (VPC) in the three regions same region (`us-east-1`), and using three subnets, each placed in a different Availability Zone to ensure high availability. An Amazon EKS (Elastic Kubernetes Service) cluster was deployed with three worker nodes — one in each AZ —to distribute the workload evenly.
For the purposes of this proof of concept, the EKS cluster is publicly accessible, and the service ports are exposed via a load balancer. All Ory components — Hydra, Kratos, and Keto — are configured to connect to the CockroachDB cluster through a Route53 Global Load Balancer (GLB), which manages traffic routing at the global level. It directs user requests to the nearest or most responsive region based on geographic proximity of the region (Geolocation routing policy).
This ensures optimal performance and continued availability even in the event of a full region outage.

- CockroachDB Cluster: we created three VPCs in `us-east-1`, `eu-west-3`, and `ap-northeast-1` with three subnets each, distributed across distinct Availability Zones.
The CockroachDB cluster itself consists of three nodes, each deployed in a separate AZ to enable fault tolerance and quorum-based consistency. A Network Load Balancer (NLB) sits in front of the cluster to evenly route incoming requests to the appropriate database node.

image::images/Multi-Region-Multi-AZ.svg[Multi-Region Multi-Zonal Configuration]

[IMPORTANT]
.Load Balancing
====
Both https://aws.amazon.com/route53/[Route53] and https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/what-is-load-balancing.html[ELB] are used to distribute the network traffic.

ELB distributes traffic among Multiple Availability Zone but not to multiple Regions. Route53 can distribute traffic among multiple Regions.
====